"use strict";(self.webpackChunkweidongkl_github_io=self.webpackChunkweidongkl_github_io||[]).push([[6062],{3764:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>g,contentTitle:()=>l,default:()=>d,frontMatter:()=>s,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"note/golang/design/oop_pinciple/ocp","title":"\u5f00\u95ed\u539f\u5219(OCP)","description":"1. \u6982\u8ff0","source":"@site/docs/note/golang/design/oop_pinciple/ocp.md","sourceDirName":"note/golang/design/oop_pinciple","slug":"/note/golang/design/oop_pinciple/ocp","permalink":"/en/docs/note/golang/design/oop_pinciple/ocp","draft":false,"unlisted":false,"editUrl":"https://github.com/weidongkl/weidongkl.github.io/tree/master/docs/note/golang/design/oop_pinciple/ocp.md","tags":[],"version":"current","lastUpdatedBy":"weidongkl","lastUpdatedAt":1747379461000,"sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"note","previous":{"title":"\u5355\u4e00\u804c\u8d23\u539f\u5219(SRP)","permalink":"/en/docs/note/golang/design/oop_pinciple/srp"},"next":{"title":"\u91cc\u6c0f\u66ff\u6362\u539f\u5219(LSP)","permalink":"/en/docs/note/golang/design/oop_pinciple/lsp"}}');var t=r(4848),i=r(8453);const s={sidebar_position:3},l="\u5f00\u95ed\u539f\u5219(OCP)",g={},c=[{value:"1. \u6982\u8ff0",id:"1-\u6982\u8ff0",level:2},{value:"2. \u6838\u5fc3\u6982\u5ff5",id:"2-\u6838\u5fc3\u6982\u5ff5",level:2},{value:"3. Go\u8bed\u8a00\u4e2d\u7684OCP\u5b9e\u73b0\u65b9\u5f0f",id:"3-go\u8bed\u8a00\u4e2d\u7684ocp\u5b9e\u73b0\u65b9\u5f0f",level:2},{value:"3.1 \u4f7f\u7528\u63a5\u53e3\u5b9e\u73b0OCP",id:"31-\u4f7f\u7528\u63a5\u53e3\u5b9e\u73b0ocp",level:3},{value:"3.2 \u6dfb\u52a0\u65b0\u652f\u4ed8\u65b9\u5f0f\uff08\u6269\u5c55\uff09",id:"32-\u6dfb\u52a0\u65b0\u652f\u4ed8\u65b9\u5f0f\u6269\u5c55",level:3},{value:"4. \u8fdd\u53cdOCP\u7684\u793a\u4f8b\u4e0e\u91cd\u6784",id:"4-\u8fdd\u53cdocp\u7684\u793a\u4f8b\u4e0e\u91cd\u6784",level:2},{value:"4.1 \u8fdd\u53cdOCP\u7684\u4ee3\u7801",id:"41-\u8fdd\u53cdocp\u7684\u4ee3\u7801",level:3},{value:"4.2 \u91cd\u6784\u4e3a\u7b26\u5408OCP\u7684\u4ee3\u7801",id:"42-\u91cd\u6784\u4e3a\u7b26\u5408ocp\u7684\u4ee3\u7801",level:3},{value:"5. Go\u8bed\u8a00\u4e2d\u5b9e\u8df5OCP\u7684\u9ad8\u7ea7\u6280\u5de7",id:"5-go\u8bed\u8a00\u4e2d\u5b9e\u8df5ocp\u7684\u9ad8\u7ea7\u6280\u5de7",level:2},{value:"5.1 \u51fd\u6570\u9009\u9879\u6a21\u5f0f(Functional Options)",id:"51-\u51fd\u6570\u9009\u9879\u6a21\u5f0ffunctional-options",level:3},{value:"5.2 \u4e2d\u95f4\u4ef6\u6a21\u5f0f",id:"52-\u4e2d\u95f4\u4ef6\u6a21\u5f0f",level:3},{value:"6. OCP\u7684\u5b9e\u9645\u5e94\u7528\u573a\u666f",id:"6-ocp\u7684\u5b9e\u9645\u5e94\u7528\u573a\u666f",level:2},{value:"7. OCP\u7684\u65e5\u5fd7\u7cfb\u7edf",id:"7-ocp\u7684\u65e5\u5fd7\u7cfb\u7edf",level:2},{value:"7.1 \u57fa\u7840\u8bbe\u8ba1",id:"71-\u57fa\u7840\u8bbe\u8ba1",level:3},{value:"7.1.1 \u5b9a\u4e49\u65e5\u5fd7\u63a5\u53e3\uff08\u62bd\u8c61\u5c42\uff09",id:"711-\u5b9a\u4e49\u65e5\u5fd7\u63a5\u53e3\u62bd\u8c61\u5c42",level:4},{value:"7.1.2 \u5b9e\u73b0\u5177\u4f53\u65e5\u5fd7\u8f93\u51fa",id:"712-\u5b9e\u73b0\u5177\u4f53\u65e5\u5fd7\u8f93\u51fa",level:4},{value:"7.2 \u7ec4\u5408\u65e5\u5fd7\u5668\uff08\u652f\u6301\u591a\u79cd\u8f93\u51fa\uff09",id:"72-\u7ec4\u5408\u65e5\u5fd7\u5668\u652f\u6301\u591a\u79cd\u8f93\u51fa",level:3},{value:"7.3 \u4f7f\u7528\u5de5\u5382\u65b9\u6cd5\u521b\u5efa\u65e5\u5fd7\u5668",id:"73-\u4f7f\u7528\u5de5\u5382\u65b9\u6cd5\u521b\u5efa\u65e5\u5fd7\u5668",level:3},{value:"7.4 \u6dfb\u52a0\u7f51\u7edc\u65e5\u5fd7\u8f93\u51fa\uff08\u6269\u5c55\u793a\u4f8b\uff09",id:"74-\u6dfb\u52a0\u7f51\u7edc\u65e5\u5fd7\u8f93\u51fa\u6269\u5c55\u793a\u4f8b",level:3},{value:"7.5 \u5b8c\u6574\u4f7f\u7528\u793a\u4f8b",id:"75-\u5b8c\u6574\u4f7f\u7528\u793a\u4f8b",level:2},{value:"8. \u603b\u7ed3",id:"8-\u603b\u7ed3",level:2}];function a(n){const e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"\u5f00\u95ed\u539f\u5219ocp",children:"\u5f00\u95ed\u539f\u5219(OCP)"})}),"\n",(0,t.jsx)(e.h2,{id:"1-\u6982\u8ff0",children:"1. \u6982\u8ff0"}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"\u5f00\u95ed\u539f\u5219(Open/Closed Principle, OCP)"})," \u662fSOLID\u539f\u5219\u4e2d\u7684\u7b2c\u4e8c\u4e2a\u539f\u5219\uff0c\u7531Bertrand Meyer\u63d0\u51fa\u3002\u5176\u6838\u5fc3\u601d\u60f3\u662f\uff1a"]}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\u8f6f\u4ef6\u5b9e\u4f53\uff08\u7c7b\u3001\u6a21\u5757\u3001\u51fd\u6570\u7b49\uff09\u5e94\u8be5\u5bf9\u6269\u5c55\u5f00\u653e\uff0c\u5bf9\u4fee\u6539\u5173\u95ed\u3002"}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["\u5728Go\u8bed\u8a00\u4e2d\uff0c\u8fd9\u4e00\u539f\u5219\u4e3b\u8981\u901a\u8fc7**\u63a5\u53e3(interface)",(0,t.jsx)(e.strong,{children:"\u548c"}),"\u7ec4\u5408(composition)**\u6765\u5b9e\u73b0\u3002"]}),"\n",(0,t.jsx)(e.h2,{id:"2-\u6838\u5fc3\u6982\u5ff5",children:"2. \u6838\u5fc3\u6982\u5ff5"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u5bf9\u6269\u5c55\u5f00\u653e"}),"\uff1a\u5141\u8bb8\u5728\u4e0d\u4fee\u6539\u73b0\u6709\u4ee3\u7801\u7684\u60c5\u51b5\u4e0b\u6dfb\u52a0\u65b0\u529f\u80fd"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u5bf9\u4fee\u6539\u5173\u95ed"}),"\uff1a\u73b0\u6709\u4ee3\u7801\u5e94\u5c3d\u53ef\u80fd\u4e0d\u88ab\u4fee\u6539\uff0c\u4ee5\u4fdd\u6301\u7a33\u5b9a\u6027"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u62bd\u8c61\u662f\u5173\u952e"}),"\uff1a\u901a\u8fc7\u62bd\u8c61\u5efa\u7acb\u7075\u6d3b\u7684\u57fa\u7840\u7ed3\u6784"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"3-go\u8bed\u8a00\u4e2d\u7684ocp\u5b9e\u73b0\u65b9\u5f0f",children:"3. Go\u8bed\u8a00\u4e2d\u7684OCP\u5b9e\u73b0\u65b9\u5f0f"}),"\n",(0,t.jsx)(e.h3,{id:"31-\u4f7f\u7528\u63a5\u53e3\u5b9e\u73b0ocp",children:"3.1 \u4f7f\u7528\u63a5\u53e3\u5b9e\u73b0OCP"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'// \u652f\u4ed8\u65b9\u5f0f\u63a5\u53e3 - \u62bd\u8c61\u5c42\ntype PaymentMethod interface {\n    Pay(amount float64) error\n}\n\n// \u4fe1\u7528\u5361\u652f\u4ed8\u5b9e\u73b0\ntype CreditCardPayment struct{}\n\nfunc (c *CreditCardPayment) Pay(amount float64) error {\n    fmt.Printf("\u652f\u4ed8 %.2f \u5143\u4f7f\u7528\u4fe1\u7528\u5361\\n", amount)\n    return nil\n}\n\n// \u652f\u4ed8\u5b9d\u652f\u4ed8\u5b9e\u73b0\ntype AlipayPayment struct{}\n\nfunc (a *AlipayPayment) Pay(amount float64) error {\n    fmt.Printf("\u652f\u4ed8 %.2f \u5143\u4f7f\u7528\u652f\u4ed8\u5b9d\\n", amount)\n    return nil\n}\n\n// \u652f\u4ed8\u5904\u7406\u5668 - \u5bf9\u4fee\u6539\u5173\u95ed\ntype PaymentProcessor struct {\n    method PaymentMethod\n}\n\nfunc (p *PaymentProcessor) ProcessPayment(amount float64) error {\n    return p.method.Pay(amount)\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"32-\u6dfb\u52a0\u65b0\u652f\u4ed8\u65b9\u5f0f\u6269\u5c55",children:"3.2 \u6dfb\u52a0\u65b0\u652f\u4ed8\u65b9\u5f0f\uff08\u6269\u5c55\uff09"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'// \u65b0\u589e\u5fae\u4fe1\u652f\u4ed8 - \u6269\u5c55\u800c\u975e\u4fee\u6539\ntype WeChatPayment struct{}\n\nfunc (w *WeChatPayment) Pay(amount float64) error {\n    fmt.Printf("\u652f\u4ed8 %.2f \u5143\u4f7f\u7528\u5fae\u4fe1\u652f\u4ed8\\n", amount)\n    return nil\n}\n\n// \u4f7f\u7528\u65b9\u5f0f\nfunc main() {\n    processor := &PaymentProcessor{method: &WeChatPayment{}}\n    processor.ProcessPayment(100.50)\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"4-\u8fdd\u53cdocp\u7684\u793a\u4f8b\u4e0e\u91cd\u6784",children:"4. \u8fdd\u53cdOCP\u7684\u793a\u4f8b\u4e0e\u91cd\u6784"}),"\n",(0,t.jsx)(e.h3,{id:"41-\u8fdd\u53cdocp\u7684\u4ee3\u7801",children:"4.1 \u8fdd\u53cdOCP\u7684\u4ee3\u7801"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'type PaymentType int\n\nconst (\n    CreditCard PaymentType = iota\n    Alipay\n)\n\n// \u76f4\u63a5\u4f9d\u8d56\u5177\u4f53\u5b9e\u73b0\nfunc ProcessPayment(paymentType PaymentType, amount float64) error {\n    switch paymentType {\n    case CreditCard:\n        fmt.Printf("\u652f\u4ed8 %.2f \u5143\u4f7f\u7528\u4fe1\u7528\u5361\\n", amount)\n    case Alipay:\n        fmt.Printf("\u652f\u4ed8 %.2f \u5143\u4f7f\u7528\u652f\u4ed8\u5b9d\\n", amount)\n    default:\n        return fmt.Errorf("\u4e0d\u652f\u6301\u7684\u652f\u4ed8\u65b9\u5f0f")\n    }\n    return nil\n}\n'})}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"\u95ee\u9898"}),"\uff1a\u6bcf\u6b21\u65b0\u589e\u652f\u4ed8\u65b9\u5f0f\u90fd\u9700\u8981\u4fee\u6539ProcessPayment\u51fd\u6570"]}),"\n",(0,t.jsx)(e.h3,{id:"42-\u91cd\u6784\u4e3a\u7b26\u5408ocp\u7684\u4ee3\u7801",children:"4.2 \u91cd\u6784\u4e3a\u7b26\u5408OCP\u7684\u4ee3\u7801"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'// \u4f7f\u7528\u63a5\u53e3\u62bd\u8c61\ntype PaymentMethod interface {\n    Pay(amount float64) error\n}\n\n// \u6ce8\u518c\u652f\u4ed8\u65b9\u5f0f\u7684\u5904\u7406\u5668\ntype PaymentHandler struct {\n    methods map[string]PaymentMethod\n}\n\nfunc (h *PaymentHandler) Register(name string, method PaymentMethod) {\n    h.methods[name] = method\n}\n\nfunc (h *PaymentHandler) Process(name string, amount float64) error {\n    if method, ok := h.methods[name]; ok {\n        return method.Pay(amount)\n    }\n    return fmt.Errorf("\u652f\u4ed8\u65b9\u5f0f\u672a\u6ce8\u518c")\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"5-go\u8bed\u8a00\u4e2d\u5b9e\u8df5ocp\u7684\u9ad8\u7ea7\u6280\u5de7",children:"5. Go\u8bed\u8a00\u4e2d\u5b9e\u8df5OCP\u7684\u9ad8\u7ea7\u6280\u5de7"}),"\n",(0,t.jsx)(e.h3,{id:"51-\u51fd\u6570\u9009\u9879\u6a21\u5f0ffunctional-options",children:"5.1 \u51fd\u6570\u9009\u9879\u6a21\u5f0f(Functional Options)"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'type Server struct {\n    host string\n    port int\n    timeout time.Duration\n}\n\ntype Option func(*Server)\n\nfunc WithHost(host string) Option {\n    return func(s *Server) {\n        s.host = host\n    }\n}\n\nfunc WithPort(port int) Option {\n    return func(s *Server) {\n        s.port = port\n    }\n}\n\nfunc NewServer(opts ...Option) *Server {\n    s := &Server{\n        host:    "localhost",\n        port:    8080,\n        timeout: 30 * time.Second,\n    }\n    for _, opt := range opts {\n        opt(s)\n    }\n    return s\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"52-\u4e2d\u95f4\u4ef6\u6a21\u5f0f",children:"5.2 \u4e2d\u95f4\u4ef6\u6a21\u5f0f"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'type Handler func(http.ResponseWriter, *http.Request)\n\nfunc LoggingMiddleware(next Handler) Handler {\n    return func(w http.ResponseWriter, r *http.Request) {\n        log.Printf("\u8bf7\u6c42\u5f00\u59cb: %s %s", r.Method, r.URL.Path)\n        next(w, r)\n        log.Printf("\u8bf7\u6c42\u7ed3\u675f: %s %s", r.Method, r.URL.Path)\n    }\n}\n\nfunc AuthMiddleware(next Handler) Handler {\n    return func(w http.ResponseWriter, r *http.Request) {\n        if r.Header.Get("Authorization") == "" {\n            http.Error(w, "\u672a\u6388\u6743", http.StatusUnauthorized)\n            return\n        }\n        next(w, r)\n    }\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"6-ocp\u7684\u5b9e\u9645\u5e94\u7528\u573a\u666f",children:"6. OCP\u7684\u5b9e\u9645\u5e94\u7528\u573a\u666f"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u652f\u4ed8\u7cfb\u7edf"}),"\uff08\u5982\u4e0a\u9762\u7684\u793a\u4f8b\uff09"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u65e5\u5fd7\u7cfb\u7edf"}),"\uff08\u6587\u4ef6\u65e5\u5fd7\u3001\u63a7\u5236\u53f0\u65e5\u5fd7\u3001\u7f51\u7edc\u65e5\u5fd7\u7b49\uff09"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u6570\u636e\u5b58\u50a8"}),"\uff08MySQL\u3001MongoDB\u3001Redis\u7b49\uff09"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u901a\u77e5\u7cfb\u7edf"}),"\uff08\u90ae\u4ef6\u3001\u77ed\u4fe1\u3001\u5fae\u4fe1\u901a\u77e5\u7b49\uff09"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u4e2d\u95f4\u4ef6\u7ba1\u9053"}),"\uff08Web\u4e2d\u95f4\u4ef6\u3001RPC\u62e6\u622a\u5668\u7b49\uff09"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"7-ocp\u7684\u65e5\u5fd7\u7cfb\u7edf",children:"7. OCP\u7684\u65e5\u5fd7\u7cfb\u7edf"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u63a7\u5236\u53f0\u8f93\u51fa"}),"\n",(0,t.jsx)(e.li,{children:"\u6587\u4ef6\u8f93\u51fa"}),"\n",(0,t.jsx)(e.li,{children:"\u672a\u6765\u53ef\u4ee5\u8f7b\u677e\u6dfb\u52a0\u7f51\u7edc\u65e5\u5fd7"}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"71-\u57fa\u7840\u8bbe\u8ba1",children:"7.1 \u57fa\u7840\u8bbe\u8ba1"}),"\n",(0,t.jsx)(e.h4,{id:"711-\u5b9a\u4e49\u65e5\u5fd7\u63a5\u53e3\u62bd\u8c61\u5c42",children:"7.1.1 \u5b9a\u4e49\u65e5\u5fd7\u63a5\u53e3\uff08\u62bd\u8c61\u5c42\uff09"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:"// Logger \u65e5\u5fd7\u63a5\u53e3 - \u6838\u5fc3\u62bd\u8c61\ntype Logger interface {\n    Log(level string, message string) error\n    Close() error\n}\n"})}),"\n",(0,t.jsx)(e.h4,{id:"712-\u5b9e\u73b0\u5177\u4f53\u65e5\u5fd7\u8f93\u51fa",children:"7.1.2 \u5b9e\u73b0\u5177\u4f53\u65e5\u5fd7\u8f93\u51fa"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\u63a7\u5236\u53f0\u65e5\u5fd7\u8f93\u51fa"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'// ConsoleLogger \u63a7\u5236\u53f0\u65e5\u5fd7\u5b9e\u73b0\ntype ConsoleLogger struct {\n    // \u53ef\u4ee5\u6dfb\u52a0\u9700\u8981\u7684\u5b57\u6bb5\uff0c\u5982\u662f\u5426\u5f69\u8272\u8f93\u51fa\u7b49\n}\n\nfunc NewConsoleLogger() *ConsoleLogger {\n    return &ConsoleLogger{}\n}\n\nfunc (c *ConsoleLogger) Log(level string, message string) error {\n    _, err := fmt.Printf("[%s] %s\\n", level, message)\n    return err\n}\n\nfunc (c *ConsoleLogger) Close() error {\n    // \u63a7\u5236\u53f0\u65e5\u5fd7\u65e0\u9700\u5173\u95ed\u8d44\u6e90\n    return nil\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\u6587\u4ef6\u65e5\u5fd7\u8f93\u51fa"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'// FileLogger \u6587\u4ef6\u65e5\u5fd7\u5b9e\u73b0\ntype FileLogger struct {\n    file *os.File\n}\n\nfunc NewFileLogger(filename string) (*FileLogger, error) {\n    file, err := os.OpenFile(filename, os.O_APPEND|os.O_CREATE|os.O_WRONLY, 0644)\n    if err != nil {\n        return nil, err\n    }\n    return &FileLogger{file: file}, nil\n}\n\nfunc (f *FileLogger) Log(level string, message string) error {\n    _, err := fmt.Fprintf(f.file, "[%s] %s %s\\n", time.Now().Format("2006-01-02 15:04:05"), level, message)\n    return err\n}\n\nfunc (f *FileLogger) Close() error {\n    return f.file.Close()\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"72-\u7ec4\u5408\u65e5\u5fd7\u5668\u652f\u6301\u591a\u79cd\u8f93\u51fa",children:"7.2 \u7ec4\u5408\u65e5\u5fd7\u5668\uff08\u652f\u6301\u591a\u79cd\u8f93\u51fa\uff09"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:"// CompositeLogger \u7ec4\u5408\u591a\u4e2a\u65e5\u5fd7\u8f93\u51fa\ntype CompositeLogger struct {\n    loggers []Logger\n}\n\nfunc NewCompositeLogger(loggers ...Logger) *CompositeLogger {\n    return &CompositeLogger{loggers: loggers}\n}\n\nfunc (c *CompositeLogger) Log(level string, message string) error {\n    for _, logger := range c.loggers {\n        if err := logger.Log(level, message); err != nil {\n            return err\n        }\n    }\n    return nil\n}\n\nfunc (c *CompositeLogger) Close() error {\n    for _, logger := range c.loggers {\n        if err := logger.Close(); err != nil {\n            return err\n        }\n    }\n    return nil\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"73-\u4f7f\u7528\u5de5\u5382\u65b9\u6cd5\u521b\u5efa\u65e5\u5fd7\u5668",children:"7.3 \u4f7f\u7528\u5de5\u5382\u65b9\u6cd5\u521b\u5efa\u65e5\u5fd7\u5668"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'// LoggerType \u5b9a\u4e49\u65e5\u5fd7\u7c7b\u578b\ntype LoggerType string\n\nconst (\n    LoggerConsole LoggerType = "console"\n    LoggerFile    LoggerType = "file"\n    // \u672a\u6765\u53ef\u4ee5\u6dfb\u52a0 LoggerNetwork\n)\n\n// LoggerConfig \u65e5\u5fd7\u914d\u7f6e\ntype LoggerConfig struct {\n    Type     LoggerType\n    FilePath string // \u4ec5\u6587\u4ef6\u65e5\u5fd7\u9700\u8981\n}\n\n// NewLoggerFromConfig \u6839\u636e\u914d\u7f6e\u521b\u5efa\u65e5\u5fd7\u5668\nfunc NewLoggerFromConfig(config LoggerConfig) (Logger, error) {\n    switch config.Type {\n    case LoggerConsole:\n        return NewConsoleLogger(), nil\n    case LoggerFile:\n        return NewFileLogger(config.FilePath)\n    default:\n        return nil, fmt.Errorf("\u672a\u77e5\u7684\u65e5\u5fd7\u7c7b\u578b: %s", config.Type)\n    }\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"74-\u6dfb\u52a0\u7f51\u7edc\u65e5\u5fd7\u8f93\u51fa\u6269\u5c55\u793a\u4f8b",children:"7.4 \u6dfb\u52a0\u7f51\u7edc\u65e5\u5fd7\u8f93\u51fa\uff08\u6269\u5c55\u793a\u4f8b\uff09"}),"\n",(0,t.jsx)(e.p,{children:"\u672a\u6765\u9700\u8981\u6dfb\u52a0\u7f51\u7edc\u65e5\u5fd7\u65f6\uff0c\u53ea\u9700\u65b0\u589e\u5b9e\u73b0\uff0c\u65e0\u9700\u4fee\u6539\u73b0\u6709\u4ee3\u7801\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'// NetworkLogger \u7f51\u7edc\u65e5\u5fd7\u5b9e\u73b0\ntype NetworkLogger struct {\n    endpoint string\n    client   *http.Client\n}\n\nfunc NewNetworkLogger(endpoint string) *NetworkLogger {\n    return &NetworkLogger{\n        endpoint: endpoint,\n        client:   &http.Client{Timeout: 5 * time.Second},\n    }\n}\n\nfunc (n *NetworkLogger) Log(level string, message string) error {\n    data := map[string]string{\n        "level":   level,\n        "message": message,\n        "time":    time.Now().Format(time.RFC3339),\n    }\n    jsonData, _ := json.Marshal(data)\n    \n    resp, err := n.client.Post(n.endpoint, "application/json", bytes.NewBuffer(jsonData))\n    if err != nil {\n        return err\n    }\n    defer resp.Body.Close()\n    \n    if resp.StatusCode >= 400 {\n        return fmt.Errorf("\u65e5\u5fd7\u670d\u52a1\u5668\u8fd4\u56de\u9519\u8bef\u72b6\u6001\u7801: %d", resp.StatusCode)\n    }\n    return nil\n}\n\nfunc (n *NetworkLogger) Close() error {\n    // \u53ef\u4ee5\u5728\u8fd9\u91cc\u5173\u95ed\u957f\u8fde\u63a5\u7b49\u8d44\u6e90\n    return nil\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"75-\u5b8c\u6574\u4f7f\u7528\u793a\u4f8b",children:"7.5 \u5b8c\u6574\u4f7f\u7528\u793a\u4f8b"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'func main() {\n    // \u521b\u5efa\u63a7\u5236\u53f0\u65e5\u5fd7\u5668\n    consoleLogger := NewConsoleLogger()\n    \n    // \u521b\u5efa\u6587\u4ef6\u65e5\u5fd7\u5668\n    fileLogger, err := NewFileLogger("app.log")\n    if err != nil {\n        panic(err)\n    }\n    \n    // \u521b\u5efa\u7ec4\u5408\u65e5\u5fd7\u5668\n    compositeLogger := NewCompositeLogger(consoleLogger, fileLogger)\n    \n    // \u4f7f\u7528\u65e5\u5fd7\n    compositeLogger.Log("INFO", "\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8")\n    compositeLogger.Log("WARN", "\u8fd9\u662f\u4e00\u4e2a\u8b66\u544a\u4fe1\u606f")\n    compositeLogger.Log("ERROR", "\u53d1\u751f\u4e86\u4e00\u4e2a\u9519\u8bef")\n    \n    // \u5173\u95ed\u6240\u6709\u65e5\u5fd7\u5668\n    if err := compositeLogger.Close(); err != nil {\n        fmt.Printf("\u5173\u95ed\u65e5\u5fd7\u5668\u65f6\u51fa\u9519: %v\\n", err)\n    }\n    \n    // \u672a\u6765\u6dfb\u52a0\u7f51\u7edc\u65e5\u5fd7\n    networkLogger := NewNetworkLogger("http://log-server.example.com/log")\n    extendedLogger := NewCompositeLogger(consoleLogger, fileLogger, networkLogger)\n    extendedLogger.Log("INFO", "\u8fd9\u6761\u65e5\u5fd7\u4f1a\u8f93\u51fa\u5230\u63a7\u5236\u53f0\u3001\u6587\u4ef6\u548c\u7f51\u7edc")\n    extendedLogger.Close()\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"8-\u603b\u7ed3",children:"8. \u603b\u7ed3"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"OCP\u7684\u6838\u5fc3\u662f\u901a\u8fc7\u62bd\u8c61\u6765\u9694\u79bb\u53d8\u5316"}),"\n",(0,t.jsx)(e.li,{children:"\u5728Go\u4e2d\u4e3b\u8981\u4f7f\u7528\u63a5\u53e3\u548c\u7ec4\u5408\u6765\u5b9e\u73b0OCP"}),"\n",(0,t.jsx)(e.li,{children:"\u51fd\u6570\u9009\u9879\u6a21\u5f0f\u548c\u4e2d\u95f4\u4ef6\u6a21\u5f0f\u662f\u5b9e\u8df5OCP\u7684\u4f18\u96c5\u65b9\u5f0f"}),"\n",(0,t.jsx)(e.li,{children:"\u5e73\u8861\u539f\u5219\uff1a\u4e0d\u8981\u8fc7\u5ea6\u8bbe\u8ba1\uff0c\u53ea\u4e3a\u9884\u671f\u7684\u53d8\u5316\u505a\u62bd\u8c61"}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"\u597d\u7684\u8bbe\u8ba1\u5e94\u8be5\u50cf\u63d2\u4ef6\u7cfb\u7edf\u4e00\u6837\u5de5\u4f5c - \u901a\u8fc7\u6dfb\u52a0\u65b0\u4ee3\u7801\u800c\u975e\u4fee\u6539\u73b0\u6709\u4ee3\u7801\u6765\u6269\u5c55\u529f\u80fd"}),"\u3002"]})]})}function d(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(a,{...n})}):a(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>s,x:()=>l});var o=r(6540);const t={},i=o.createContext(t);function s(n){const e=o.useContext(i);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:s(n.components),o.createElement(i.Provider,{value:e},n.children)}}}]);