"use strict";(self.webpackChunkweidongkl_github_io=self.webpackChunkweidongkl_github_io||[]).push([[4897,8166],{47834:(n,t,e)=>{e.r(t),e.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"note/golang/design/standard_design_patterns/create/factory","title":"\u5de5\u5382\u6a21\u5f0f\uff08Factory Pattern\uff09","description":"1. \u6982\u8ff0","source":"@site/docs/note/golang/design/standard_design_patterns/create/factory.md","sourceDirName":"note/golang/design/standard_design_patterns/create","slug":"/note/golang/design/standard_design_patterns/create/factory","permalink":"/docs/note/golang/design/standard_design_patterns/create/factory","draft":false,"unlisted":false,"editUrl":"https://github.com/weidongkl/weidongkl.github.io/tree/master/docs/note/golang/design/standard_design_patterns/create/factory.md","tags":[],"version":"current","lastUpdatedBy":"weidongkl","lastUpdatedAt":1763349834000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"note","previous":{"title":"\u521b\u5efa\u8005\u8bbe\u8ba1\u6a21\u5f0f","permalink":"/docs/category/\u521b\u5efa\u8005\u8bbe\u8ba1\u6a21\u5f0f-1"},"next":{"title":"\u884c\u4e3a\u8bbe\u8ba1\u6a21\u5f0f","permalink":"/docs/category/\u884c\u4e3a\u8bbe\u8ba1\u6a21\u5f0f-1"}}');var a=e(74848),c=e(28453);const o={sidebar_position:1},i="\u5de5\u5382\u6a21\u5f0f\uff08Factory Pattern\uff09",s={},l=[{value:"1. \u6982\u8ff0",id:"1-\u6982\u8ff0",level:2},{value:"2. \u7b80\u5355\u5de5\u5382\uff08Simple Factory\uff09",id:"2-\u7b80\u5355\u5de5\u5382simple-factory",level:2},{value:"2.1 \u793a\u4f8b\uff1a\u56fe\u5f62\u521b\u5efa\u5668",id:"21-\u793a\u4f8b\u56fe\u5f62\u521b\u5efa\u5668",level:3},{value:"2.2 \u793a\u4f8b\uff1a\u7f51\u7edc\u8fde\u63a5",id:"22-\u793a\u4f8b\u7f51\u7edc\u8fde\u63a5",level:3},{value:"2.3 \u4f18\u7f3a\u70b9",id:"23-\u4f18\u7f3a\u70b9",level:3},{value:"3. \u5de5\u5382\u65b9\u6cd5\uff08Factory Method\uff09",id:"3-\u5de5\u5382\u65b9\u6cd5factory-method",level:2},{value:"3.1 \u793a\u4f8b\uff1a\u6570\u636e\u5e93\u8fde\u63a5\u5668",id:"31-\u793a\u4f8b\u6570\u636e\u5e93\u8fde\u63a5\u5668",level:3},{value:"3.2 \u793a\u4f8b\uff1a\u65e5\u5fd7\u7cfb\u7edf",id:"32-\u793a\u4f8b\u65e5\u5fd7\u7cfb\u7edf",level:3},{value:"3.3 \u4f18\u7f3a\u70b9",id:"33-\u4f18\u7f3a\u70b9",level:3},{value:"4. \u62bd\u8c61\u5de5\u5382\uff08Abstract Factory\uff09",id:"4-\u62bd\u8c61\u5de5\u5382abstract-factory",level:2},{value:"4.1 \u793a\u4f8b\uff1aUI \u5de5\u5382\uff08\u6309\u94ae + \u6587\u672c\u6846\uff09",id:"41-\u793a\u4f8bui-\u5de5\u5382\u6309\u94ae--\u6587\u672c\u6846",level:3},{value:"4.2 \u4f18\u7f3a\u70b9",id:"42-\u4f18\u7f3a\u70b9",level:3},{value:"5. \u51fd\u6570\u5f0f\u5de5\u5382\uff08Functional Factory\uff09",id:"5-\u51fd\u6570\u5f0f\u5de5\u5382functional-factory",level:2},{value:"5.1 \u4f18\u70b9",id:"51-\u4f18\u70b9",level:3},{value:"6.  \u5de5\u5382\u6a21\u5f0f\u5e94\u7528\u573a\u666f",id:"6--\u5de5\u5382\u6a21\u5f0f\u5e94\u7528\u573a\u666f",level:2},{value:"7. \u5c0f\u7ed3\u5bf9\u6bd4",id:"7-\u5c0f\u7ed3\u5bf9\u6bd4",level:2}];function d(n){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"\u5de5\u5382\u6a21\u5f0ffactory-pattern",children:"\u5de5\u5382\u6a21\u5f0f\uff08Factory Pattern\uff09"})}),"\n",(0,a.jsx)(t.h2,{id:"1-\u6982\u8ff0",children:"1. \u6982\u8ff0"}),"\n",(0,a.jsxs)(t.p,{children:["\u5de5\u5382\u6a21\u5f0f\u662f\u4e00\u79cd\u521b\u5efa\u578b\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u76ee\u7684\u662f",(0,a.jsx)(t.strong,{children:"\u5c06\u5bf9\u8c61\u7684\u521b\u5efa\u8fc7\u7a0b\u4e0e\u4f7f\u7528\u8fc7\u7a0b\u5206\u79bb"}),"\uff0c\u4ece\u800c\u964d\u4f4e\u4ee3\u7801\u8026\u5408\u3001\u589e\u5f3a\u6269\u5c55\u6027\u3002"]}),"\n",(0,a.jsx)(t.p,{children:"\u5728 Go \u4e2d\uff0c\u867d\u7136\u6ca1\u6709\u7c7b\u548c\u7ee7\u627f\uff0c\u4f46\u53ef\u4ee5\u901a\u8fc7\u63a5\u53e3 + \u5de5\u5382\u51fd\u6570/\u7ed3\u6784\u6765\u5b9e\u73b0\u76f8\u540c\u601d\u60f3\u3002"}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsx)(t.h2,{id:"2-\u7b80\u5355\u5de5\u5382simple-factory",children:"2. \u7b80\u5355\u5de5\u5382\uff08Simple Factory\uff09"}),"\n",(0,a.jsx)(t.h3,{id:"21-\u793a\u4f8b\u56fe\u5f62\u521b\u5efa\u5668",children:"2.1 \u793a\u4f8b\uff1a\u56fe\u5f62\u521b\u5efa\u5668"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",children:'package main\n\nimport "fmt"\n\n// \u63a5\u53e3\ntype Shape interface {\n\tDraw()\n}\n\n// \u5b9e\u73b0\u7c7b\ntype Circle struct{}\nfunc (c Circle) Draw() { fmt.Println("Drawing Circle") }\n\ntype Square struct{}\nfunc (s Square) Draw() { fmt.Println("Drawing Square") }\n\n// \u7b80\u5355\u5de5\u5382\nfunc ShapeFactory(shapeType string) Shape {\n\tswitch shapeType {\n\tcase "circle":\n\t\treturn Circle{}\n\tcase "square":\n\t\treturn Square{}\n\tdefault:\n\t\treturn nil\n\t}\n}\n\nfunc main() {\n\ts1 := ShapeFactory("circle")\n\ts2 := ShapeFactory("square")\n\ts1.Draw()\n\ts2.Draw()\n}\n'})}),"\n",(0,a.jsx)(t.h3,{id:"22-\u793a\u4f8b\u7f51\u7edc\u8fde\u63a5",children:"2.2 \u793a\u4f8b\uff1a\u7f51\u7edc\u8fde\u63a5"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",children:'// \u8fde\u63a5\u63a5\u53e3\ntype Conn interface {\n    Send([]byte) error\n    Receive() ([]byte, error)\n}\n\n// \u7b80\u5355\u5de5\u5382\u5b9e\u73b0\nfunc NewConn(network string, addr string) (Conn, error) {\n    switch network {\n    case "tcp":\n        return &TCPConn{addr: addr}, nil\n    case "unix":\n        return &UnixConn{path: addr}, nil\n    case "http":\n        return &HTTPConn{url: addr}, nil\n    default:\n        return nil, fmt.Errorf("unsupported network")\n    }\n}\n\n// \u4f7f\u7528\u793a\u4f8b\nfunc main() {\n    conn, _ := NewConn("http", "https://api.example.com")\n    conn.Send([]byte("GET /"))\n}\n'})}),"\n",(0,a.jsx)(t.h3,{id:"23-\u4f18\u7f3a\u70b9",children:"2.3 \u4f18\u7f3a\u70b9"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"\u2705 \u7b80\u5355\u76f4\u63a5\uff0c\u9002\u5408\u5c0f\u89c4\u6a21\u4f7f\u7528"}),"\n",(0,a.jsxs)(t.li,{children:["\u274c \u589e\u52a0\u65b0\u7c7b\u578b\u8981\u4fee\u6539\u5de5\u5382\uff0c\u8fdd\u53cd\u5f00\u95ed\u539f\u5219\uff08",(0,a.jsx)(t.code,{children:"OCP"}),"\uff09"]}),"\n"]}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsx)(t.h2,{id:"3-\u5de5\u5382\u65b9\u6cd5factory-method",children:"3. \u5de5\u5382\u65b9\u6cd5\uff08Factory Method\uff09"}),"\n",(0,a.jsx)(t.h3,{id:"31-\u793a\u4f8b\u6570\u636e\u5e93\u8fde\u63a5\u5668",children:"3.1 \u793a\u4f8b\uff1a\u6570\u636e\u5e93\u8fde\u63a5\u5668"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",children:'package main\n\nimport "fmt"\n\n// \u63a5\u53e3\ntype DBConnector interface {\n\tConnect()\n}\n\n// \u5b9e\u73b0\ntype MySQLConnector struct{}\nfunc (m MySQLConnector) Connect() { fmt.Println("MySQL connected") }\n\ntype PostgresConnector struct{}\nfunc (p PostgresConnector) Connect() { fmt.Println("Postgres connected") }\n\n// \u5de5\u5382\u63a5\u53e3\ntype DBFactory interface {\n\tCreateConnector() DBConnector\n}\n\n// \u5b9e\u73b0\u5de5\u5382\ntype MySQLFactory struct{}\nfunc (f MySQLFactory) CreateConnector() DBConnector { return MySQLConnector{} }\n\ntype PostgresFactory struct{}\nfunc (f PostgresFactory) CreateConnector() DBConnector { return PostgresConnector{} }\n\nfunc main() {\n\tvar factory DBFactory\n\tfactory = MySQLFactory{}\n\tconn := factory.CreateConnector()\n\tconn.Connect()\n\n\tfactory = PostgresFactory{}\n\tconn = factory.CreateConnector()\n\tconn.Connect()\n}\n'})}),"\n",(0,a.jsx)(t.h3,{id:"32-\u793a\u4f8b\u65e5\u5fd7\u7cfb\u7edf",children:"3.2 \u793a\u4f8b\uff1a\u65e5\u5fd7\u7cfb\u7edf"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",children:'// \u65e5\u5fd7\u63a5\u53e3\ntype Logger interface {\n    Log(level string, msg string)\n}\n\n// \u5de5\u5382\u63a5\u53e3\ntype LoggerFactory interface {\n    Create() Logger\n}\n\n// \u6587\u4ef6\u65e5\u5fd7\u5b9e\u73b0\ntype FileLogger struct {\n    path string\n}\n\nfunc (f *FileLogger) Log(level, msg string) {\n    // \u5b9e\u73b0\u6587\u4ef6\u5199\u5165\n}\n\ntype FileLoggerFactory struct {\n    path string\n}\n\nfunc (f *FileLoggerFactory) Create() Logger {\n    return &FileLogger{path: f.path}\n}\n\n// \u63a7\u5236\u53f0\u65e5\u5fd7\u5b9e\u73b0\ntype ConsoleLogger struct{}\n\nfunc (c *ConsoleLogger) Log(level, msg string) {\n    fmt.Printf("[%s] %s\\n", level, msg)\n}\n\ntype ConsoleLoggerFactory struct{}\n\nfunc (f *ConsoleLoggerFactory) Create() Logger {\n    return &ConsoleLogger{}\n}\n\n// \u4f7f\u7528\u793a\u4f8b\nfunc getLoggerFactory(env string) LoggerFactory {\n    if env == "production" {\n        return &FileLoggerFactory{path: "/var/log/app.log"}\n    }\n    return &ConsoleLoggerFactory{}\n}\n\nfunc main() {\n    factory := getLoggerFactory(os.Getenv("APP_ENV"))\n    logger := factory.Create()\n    logger.Log("INFO", "application started")\n}\n'})}),"\n",(0,a.jsx)(t.h3,{id:"33-\u4f18\u7f3a\u70b9",children:"3.3 \u4f18\u7f3a\u70b9"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"\u2705 \u9075\u5faa\u5f00\u95ed\u539f\u5219\uff0c\u65b0\u589e\u7c7b\u578b\u65e0\u9700\u6539\u65e7\u4ee3\u7801"}),"\n",(0,a.jsx)(t.li,{children:"\u274c \u7c7b\uff08\u7ed3\u6784\uff09\u589e\u591a\uff0c\u4ee3\u7801\u7ed3\u6784\u590d\u6742"}),"\n"]}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsx)(t.h2,{id:"4-\u62bd\u8c61\u5de5\u5382abstract-factory",children:"4. \u62bd\u8c61\u5de5\u5382\uff08Abstract Factory\uff09"}),"\n",(0,a.jsx)(t.h3,{id:"41-\u793a\u4f8bui-\u5de5\u5382\u6309\u94ae--\u6587\u672c\u6846",children:"4.1 \u793a\u4f8b\uff1aUI \u5de5\u5382\uff08\u6309\u94ae + \u6587\u672c\u6846\uff09"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",children:'package main\n\nimport "fmt"\n\n// \u4ea7\u54c1\u63a5\u53e3\u65cf\ntype Button interface {\n\tPaint()\n}\ntype Textbox interface {\n\tDraw()\n}\n\n// Windows \u7cfb\u5217\ntype WindowsButton struct{}\nfunc (WindowsButton) Paint() { fmt.Println("Windows Button") }\n\ntype WindowsTextbox struct{}\nfunc (WindowsTextbox) Draw() { fmt.Println("Windows Textbox") }\n\n// Mac \u7cfb\u5217\ntype MacButton struct{}\nfunc (MacButton) Paint() { fmt.Println("Mac Button") }\n\ntype MacTextbox struct{}\nfunc (MacTextbox) Draw() { fmt.Println("Mac Textbox") }\n\n// \u62bd\u8c61\u5de5\u5382\u63a5\u53e3\ntype GUIFactory interface {\n\tCreateButton() Button\n\tCreateTextbox() Textbox\n}\n\n// \u5177\u4f53\u5de5\u5382\ntype WindowsFactory struct{}\nfunc (WindowsFactory) CreateButton() Button { return WindowsButton{} }\nfunc (WindowsFactory) CreateTextbox() Textbox { return WindowsTextbox{} }\n\ntype MacFactory struct{}\nfunc (MacFactory) CreateButton() Button { return MacButton{} }\nfunc (MacFactory) CreateTextbox() Textbox { return MacTextbox{} }\n\n// \u4f7f\u7528\nfunc main() {\n\tvar factory GUIFactory\n\n\tfactory = WindowsFactory{}\n\tfactory.CreateButton().Paint()\n\tfactory.CreateTextbox().Draw()\n\n\tfactory = MacFactory{}\n\tfactory.CreateButton().Paint()\n\tfactory.CreateTextbox().Draw()\n}\n'})}),"\n",(0,a.jsx)(t.h3,{id:"42-\u4f18\u7f3a\u70b9",children:"4.2 \u4f18\u7f3a\u70b9"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"\u2705 \u4fdd\u8bc1\u4e00\u7ec4\u4ea7\u54c1\u7684\u4e00\u81f4\u6027\uff08\u540c\u5c5e\u4e00\u4e2a\u7cfb\u7edf\uff09"}),"\n",(0,a.jsx)(t.li,{children:"\u274c \u6269\u5c55\u4ea7\u54c1\u65cf\u56f0\u96be\uff08\u9700\u8981\u4fee\u6539\u63a5\u53e3\uff09"}),"\n"]}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsx)(t.h2,{id:"5-\u51fd\u6570\u5f0f\u5de5\u5382functional-factory",children:"5. \u51fd\u6570\u5f0f\u5de5\u5382\uff08Functional Factory\uff09"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",children:'package main\n\nimport "fmt"\n\ntype Animal interface {\n\tSpeak()\n}\n\ntype Dog struct{}\nfunc (Dog) Speak() { fmt.Println("Woof!") }\n\ntype Cat struct{}\nfunc (Cat) Speak() { fmt.Println("Meow!") }\n\nvar animalRegistry = make(map[string]func() Animal)\n\nfunc RegisterAnimal(name string, factory func() Animal) {\n\tanimalRegistry[name] = factory\n}\n\nfunc GetAnimal(name string) Animal {\n\tif f, ok := animalRegistry[name]; ok {\n\t\treturn f()\n\t}\n\treturn nil\n}\n\nfunc main() {\n\tRegisterAnimal("dog", func() Animal { return Dog{} })\n\tRegisterAnimal("cat", func() Animal { return Cat{} })\n\n\tGetAnimal("dog").Speak()\n\tGetAnimal("cat").Speak()\n}\n'})}),"\n",(0,a.jsx)(t.h3,{id:"51-\u4f18\u70b9",children:"5.1 \u4f18\u70b9"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"\u2705 \u9ad8\u5ea6\u89e3\u8026\uff0c\u4fbf\u4e8e\u63d2\u4ef6\u5316\u5f00\u53d1"}),"\n",(0,a.jsx)(t.li,{children:"\u2705 \u65b0\u589e\u4ea7\u54c1\u65e0\u9700\u6539\u52a8\u65e7\u5de5\u5382\u903b\u8f91"}),"\n"]}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsx)(t.h2,{id:"6--\u5de5\u5382\u6a21\u5f0f\u5e94\u7528\u573a\u666f",children:"6.  \u5de5\u5382\u6a21\u5f0f\u5e94\u7528\u573a\u666f"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"\u2705 \u65e5\u5fd7\u3001\u6570\u636e\u5e93\u3001\u914d\u7f6e\u9002\u914d\u5668"}),"\n",(0,a.jsx)(t.li,{children:"\u2705 \u63d2\u4ef6\u7cfb\u7edf\u3001\u9a71\u52a8\u5c42\u62bd\u8c61"}),"\n",(0,a.jsx)(t.li,{children:"\u2705 UI \u5de5\u5177\u5305\u7684\u4e3b\u9898/\u76ae\u80a4\u5207\u6362"}),"\n"]}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsx)(t.h2,{id:"7-\u5c0f\u7ed3\u5bf9\u6bd4",children:"7. \u5c0f\u7ed3\u5bf9\u6bd4"}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"\u7c7b\u578b"}),(0,a.jsx)(t.th,{children:"\u662f\u5426\u53ef\u6269\u5c55"}),(0,a.jsx)(t.th,{children:"\u7b80\u6d01\u6027"}),(0,a.jsx)(t.th,{children:"\u5e94\u7528\u8303\u56f4"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"\u7b80\u5355\u5de5\u5382"}),(0,a.jsx)(t.td,{children:"\u274c \u4e0d\u6613\u6269\u5c55"}),(0,a.jsx)(t.td,{children:"\u2705"}),(0,a.jsx)(t.td,{children:"\u5c0f\u9879\u76ee"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"\u5de5\u5382\u65b9\u6cd5"}),(0,a.jsx)(t.td,{children:"\u2705"}),(0,a.jsx)(t.td,{children:"\u2705"}),(0,a.jsx)(t.td,{children:"\u901a\u7528"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"\u62bd\u8c61\u5de5\u5382"}),(0,a.jsx)(t.td,{children:"\u2705\uff08\u4ea7\u54c1\uff09"}),(0,a.jsx)(t.td,{children:"\u274c"}),(0,a.jsx)(t.td,{children:"\u7cfb\u5217\u4ea7\u54c1"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"\u51fd\u6570\u5f0f\u6ce8\u518c"}),(0,a.jsx)(t.td,{children:"\u2705"}),(0,a.jsx)(t.td,{children:"\u2705"}),(0,a.jsx)(t.td,{children:"\u63d2\u4ef6\u5f0f\u67b6\u6784"})]})]})]})]})}function u(n={}){const{wrapper:t}={...(0,c.R)(),...n.components};return t?(0,a.jsx)(t,{...n,children:(0,a.jsx)(d,{...n})}):d(n)}},28453:(n,t,e)=>{e.d(t,{R:()=>o,x:()=>i});var r=e(96540);const a={},c=r.createContext(a);function o(n){const t=r.useContext(c);return r.useMemo((function(){return"function"==typeof n?n(t):{...t,...n}}),[t,n])}function i(n){let t;return t=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:o(n.components),r.createElement(c.Provider,{value:t},n.children)}}}]);